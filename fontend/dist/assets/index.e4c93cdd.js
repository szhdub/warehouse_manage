import{s as e,r as l,m as a,o as t,e as u,w as o,g as r,v as s,A as d,h as n,E as p,f as i,F as m,p as c,l as b,G as y,u as f,x as g,t as h,n as N,D as v,j as V,_ as w}from"./vendor.15027bbd.js";import{a as _,g as k,e as I,d as x,p as U}from"./index.c283ea82.js";const C={class:"dialog-footer"},B=n("取消"),z=n("确定"),T={emits:["ok"],setup(n,{expose:i,emit:m}){const c=e(!1),b=l({buyId:"",storeName:"",productName:"",buyNum:"",factBuyNum:""}),y=l({buyNum:[{required:!0,message:"请输入预计采购数量",trigger:"blur"}],factBuyNum:[{required:!0,message:"请输入实际采购数量",trigger:"blur"}]}),f=()=>{c.value=!1},g=e(),h=()=>{g.value.validate((e=>{e&&_("/purchase/purchase-update",b).then((e=>{m("ok"),p.success(e.message),c.value=!1}))}))};return i({open:e=>{for(let l in e)b[l]=e[l];c.value=!0}}),(e,l)=>{const n=a("el-input"),p=a("el-form-item"),i=a("el-form"),m=a("el-button"),N=a("el-dialog");return t(),u(N,{modelValue:c.value,"onUpdate:modelValue":l[5]||(l[5]=e=>c.value=e),title:"修改采购单",width:"400px",onClose:f,"destroy-on-close":""},{footer:o((()=>[r("span",C,[s(m,{onClick:f},{default:o((()=>[B])),_:1}),s(m,{type:"primary",onClick:h},{default:o((()=>[z])),_:1})])])),default:o((()=>[s(i,{ref:g,model:d(b),rules:d(y),"label-position":"top","label-width":"120px"},{default:o((()=>[s(p,{label:"采购单号：",prop:"buyId"},{default:o((()=>[s(n,{modelValue:d(b).buyId,"onUpdate:modelValue":l[0]||(l[0]=e=>d(b).buyId=e),disabled:""},null,8,["modelValue"])])),_:1}),s(p,{label:"仓库：",prop:"storeName"},{default:o((()=>[s(n,{modelValue:d(b).storeName,"onUpdate:modelValue":l[1]||(l[1]=e=>d(b).storeName=e),disabled:""},null,8,["modelValue"])])),_:1}),s(p,{label:"商品名称：",prop:"productName"},{default:o((()=>[s(n,{modelValue:d(b).productName,"onUpdate:modelValue":l[2]||(l[2]=e=>d(b).productName=e),disabled:""},null,8,["modelValue"])])),_:1}),s(p,{label:"预计采购数量：",prop:"buyNum"},{default:o((()=>[s(n,{modelValue:d(b).buyNum,"onUpdate:modelValue":l[3]||(l[3]=e=>d(b).buyNum=e),"controls-position":"right"},null,8,["modelValue"])])),_:1}),s(p,{label:"实际采购数量：",prop:"factBuyNum"},{default:o((()=>[s(n,{modelValue:d(b).factBuyNum,"onUpdate:modelValue":l[4]||(l[4]=e=>d(b).factBuyNum=e),"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}}};c("data-v-6e7e20e0");const H=r("svg",{t:"1646977561352",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3057",width:"200",height:"200"},[r("path",{d:"M986.304 871.424L747.328 630.4c-2.816-2.752-5.888-4.928-8.768-7.232 40.32-62.464 63.936-136.832 63.936-216.96 0-220.16-176.96-398.592-395.392-398.592C188.8 7.616 11.712 186.048 11.712 406.208s177.088 398.592 395.392 398.592a391.232 391.232 0 0 0 215.36-64.576c2.24 3.072 4.352 6.08 7.04 8.832l239.04 241.024a82.688 82.688 0 0 0 117.76 0 84.48 84.48 0 0 0 0-118.656m-579.2-192.512c-149.12 0-270.528-122.368-270.528-272.704 0-150.4 121.344-272.768 270.528-272.768 149.12 0 270.528 122.432 270.528 272.768 0 150.4-121.408 272.704-270.528 272.704","p-id":"3058"})],-1),S=n("  查  询 "),j=r("svg",{t:"1647313957290",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2289",width:"200",height:"200"},[r("path",{d:"M395.9 406H288.5c-2.8 0-5.7-0.7-8.1-2.4-18.4-13.1-18.2-34.3-6.4-46.3l217.6-220.9c11.1-11.2 29.2-11.4 40.4-0.3l0.3 0.3 217.7 221c11.1 11.3 10.9 29.4-0.4 40.4-5.3 5.2-12.5 8.2-19.9 8.2H628.1v215.7c0 7.9-6.4 14.3-14.3 14.3H410.2c-7.9 0-14.3-6.4-14.3-14.3V406zM283.3 652.4v87.5c0 7.9 6.4 14.3 14.3 14.3h428.8c7.9 0 14.3-6.4 14.3-14.3v-87.5c0-7.9 6.4-14.3 14.3-14.3h142.9c7.9 0 14.3 6.4 14.3 14.3V914c0 7.9-6.4 14.3-14.3 14.3H126.1c-7.9 0-14.3-6.4-14.3-14.3V652.4c0-7.9 6.4-14.3 14.3-14.3H269c7.9 0 14.3 6.4 14.3 14.3z","p-id":"2290"})],-1),q=n("  导出数据 "),M=n("生成入库单");b();const P={setup(n){const c=y(),b=l({storeId:1,startTime:"",endTime:"",productName:"",buyUser:"",isIn:"",pageSize:5,pageNum:1,totalNum:0}),_=e(),C=()=>{c.query.storeId&&(b.storeId=parseInt(c.query.storeId)),k("/purchase/purchase-page-list",b).then((e=>{_.value=e.data.resultList,b.totalNum=e.data.totalNum}))};C();const B=e();k("/purchase/store-list").then((e=>{B.value=e.data}));const z=()=>{k("/purchase/exportTable",b).then((e=>{const l=e.data;l.reduce(((e,l)=>(l.isIn=1==l.isIn?"已入库":"未入库",e)),[]);I([{title:"仓库名",key:"storeName"},{title:"商品名",key:"productName"},{title:"预计采购数量",key:"buyNum"},{title:"实际采购数量",key:"factBuyNum"},{title:"采购人",key:"buyUser"},{title:"采购时间",key:"buyTime"},{title:"采购人电话",key:"phone"},{title:"入库状态",key:"isIn"}],l,"采购单列表")}))},P=e();f();const F=e=>{b.pageSize=e,C()},L=e=>{b.pageNum=e,C()};return(e,l)=>{const n=a("el-option"),c=a("el-select"),y=a("el-form-item"),f=a("el-input"),k=a("el-icon"),I=a("el-button"),A=a("el-form"),D=a("el-table-column"),E=a("el-table"),G=a("el-pagination");return t(),i(m,null,[r("div",null,[s(A,{inline:"",class:"searchForm"},{default:o((()=>[s(y,null,{default:o((()=>[s(c,{modelValue:d(b).storeId,"onUpdate:modelValue":l[0]||(l[0]=e=>d(b).storeId=e),style:{width:"120px"},clearable:""},{default:o((()=>[(t(!0),i(m,null,g(B.value,(e=>(t(),u(n,{label:e.storeName,value:e.storeId,key:e.storeId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(y,{label:"开始时间:"},{default:o((()=>[s(f,{type:"date",modelValue:d(b).startTime,"onUpdate:modelValue":l[1]||(l[1]=e=>d(b).startTime=e),style:{width:"120px"},clearable:""},null,8,["modelValue"])])),_:1}),s(y,{label:"结束时间:"},{default:o((()=>[s(f,{type:"date",modelValue:d(b).endTime,"onUpdate:modelValue":l[2]||(l[2]=e=>d(b).endTime=e),style:{width:"120px"},clearable:""},null,8,["modelValue"])])),_:1}),s(y,null,{default:o((()=>[s(f,{modelValue:d(b).productName,"onUpdate:modelValue":l[3]||(l[3]=e=>d(b).productName=e),placeholder:"商品名称",style:{width:"120px"},clearable:""},null,8,["modelValue"])])),_:1}),s(y,null,{default:o((()=>[s(f,{modelValue:d(b).buyUser,"onUpdate:modelValue":l[4]||(l[4]=e=>d(b).buyUser=e),placeholder:"采购人",style:{width:"120px"},clearable:""},null,8,["modelValue"])])),_:1}),s(y,null,{default:o((()=>[s(c,{modelValue:d(b).isIn,"onUpdate:modelValue":l[5]||(l[5]=e=>d(b).isIn=e),style:{width:"130px"},clearable:""},{default:o((()=>[s(n,{label:"不生成入库单",value:0}),s(n,{label:"生成入库单",value:1})])),_:1},8,["modelValue"])])),_:1}),s(y,null,{default:o((()=>[s(I,{type:"primary",onClick:C},{default:o((()=>[s(k,null,{default:o((()=>[H])),_:1}),S])),_:1})])),_:1})])),_:1}),r("div",null,[s(I,{type:"warning",onClick:z},{default:o((()=>[s(k,null,{default:o((()=>[j])),_:1}),q])),_:1})])]),s(E,{data:_.value,style:{width:"100%","margin-top":"10px"},"table-layout":"auto",size:"large",border:"",stripe:""},{default:o((()=>[s(D,{type:"index",width:"50"}),s(D,{prop:"storeName",label:"仓库名",sortable:""}),s(D,{prop:"productName",label:"商品名",sortable:""}),s(D,{prop:"buyNum",label:"预计采购数量",sortable:""}),s(D,{prop:"factBuyNum",label:"实际采购数量",sortable:""}),s(D,{prop:"buyUser",label:"采购人",sortable:""}),s(D,{prop:"buyTime",label:"采购时间",sortable:""}),s(D,{prop:"phone",label:"采购人电话",sortable:""}),s(D,{label:"入库状态",sortable:""},{default:o((e=>[r("span",{class:N({red:0==e.row.isIn,green:1==e.row.isIn})},h(0==e.row.isIn?"未入库":"已入库"),3)])),_:1}),s(D,{label:"操作"},{default:o((e=>[e.row.factBuyNum&&0!=e.row.factBuyNum?V("",!0):(t(),u(I,{key:0,type:"primary",title:"修改采购单",icon:d(v),circle:"",onClick:l=>{return a=e.row,void P.value.open(a);var a}},null,8,["icon","onClick"])),e.row.factBuyNum&&0!=e.row.factBuyNum?V("",!0):(t(),u(I,{key:1,type:"danger",title:"删除采购单",icon:d(w),circle:"",onClick:l=>{return a=e.row.buyId,void x(`/purchase/purchase-delete/${a}`,null,{title:"提示",message:"您确定删除该采购单吗？"}).then((e=>{p.success(e.message),C()}));var a}},null,8,["icon","onClick"])),0==e.row.isIn&&e.row.factBuyNum>0?(t(),u(I,{key:2,type:"primary",onClick:l=>{return a=e.row,void U("/purchase/in-warehouse-record-add",a).then((e=>{p.success(e.message),C()}));var a}},{default:o((()=>[M])),_:2},1032,["onClick"])):V("",!0)])),_:1})])),_:1},8,["data"]),s(G,{background:"",total:d(b).totalNum,"page-sizes":[5,10,15,20,25,30],"page-size":d(b).pageSize,"onUpdate:page-size":l[6]||(l[6]=e=>d(b).pageSize=e),currentPage:d(b).pageNum,"onUpdate:currentPage":l[7]||(l[7]=e=>d(b).pageNum=e),layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"},onSizeChange:F,onCurrentChange:L},null,8,["total","page-size","currentPage"]),s(T,{ref:P,onOk:C},null,512)],64)}},__scopeId:"data-v-6e7e20e0"};export default P;
