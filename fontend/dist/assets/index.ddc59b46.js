import{a as e,g as a,p as l,d as t}from"./index.c283ea82.js";import{s as u,r as o,m as d,o as r,e as s,w as h,g as n,v as c,A as m,h as p,E as i,j as f,f as v,F as b}from"./vendor.15027bbd.js";const k={class:"dialog-footer"},y=p("取消"),V=p("确认修改"),g={emits:["ok"],setup(a,{expose:l,emit:t}){const p=u(!1),f=o({authId:"",authName:"",authDesc:""}),v=o({authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}]}),b=u(),g=()=>{b.value.validate((a=>{a&&e("/auth/auth-update",f).then((e=>{t("ok"),i.success(e.message),p.value=!1}))}))};return l({open:e=>{f.authId=e.authId,f.authName=e.authName,f.authDesc=e.authDesc,p.value=!0}}),(e,a)=>{const l=d("el-input"),t=d("el-form-item"),u=d("el-form"),o=d("el-button"),i=d("el-dialog");return r(),s(i,{modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=e=>p.value=e),title:"修改权限信息",width:"25%"},{footer:h((()=>[n("span",k,[c(o,{onClick:a[2]||(a[2]=e=>p.value=!1)},{default:h((()=>[y])),_:1}),c(o,{type:"primary",onClick:g},{default:h((()=>[V])),_:1})])])),default:h((()=>[c(u,{ref:b,model:m(f),rules:m(v),"label-position":"top"},{default:h((()=>[c(t,{label:"名称：",prop:"authName"},{default:h((()=>[c(l,{modelValue:m(f).authName,"onUpdate:modelValue":a[0]||(a[0]=e=>m(f).authName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),c(t,{label:"权限描述：",prop:"authDesc"},{default:h((()=>[c(l,{modelValue:m(f).authDesc,"onUpdate:modelValue":a[1]||(a[1]=e=>m(f).authDesc=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}}},_={class:"dialog-footer"},C=p("取消"),G=p("添加"),U={emits:["ok"],setup(e,{expose:t,emit:p}){const v=u(!1),b=o({parentId:0,authName:"",authDesc:"",authUrl:"",authCode:"",authGrade:0,authType:""}),k=()=>{for(let e in b)b[e]="";v.value=!1},y=u(),V=o({authName:[{validator:async(e,l,t)=>{if(""===(l=l.trim()))return t(new Error("请输入权限名称！"));return!!(await a(`/auth/name-check?authName=${l}`)).data||t(new Error("该权限名称已存在！"))},trigger:"blur"}],authUrl:[{validator:async(e,l,t)=>{if(""===(l=l.trim()))return t(new Error("请输入权限url！"));return!!(await a(`/auth/url-check?authUrl=${l}`)).data||t(new Error("该权限url已存在！"))},trigger:"blur"}],authCode:[{validator:async(e,l,t)=>{if(""===(l=l.trim()))return t(new Error("请输入权限code！"));return(await a(`/auth/code-check?authCode=${l}`)).data||t(new Error("该权限code已存在！")),!0},trigger:"blur"}]}),g=u(),U=()=>{g.value.validate((e=>{e&&l("/auth/auth-add",b).then((e=>{p("ok"),i.success(e.message),v.value=!1}))}))};return t({open:e=>{v.value=!0,e?(b.parentId=e.authId,1==e.authGrade?(b.authType=2,b.authGrade=2,y.value="列表"):2==e.authGrade&&(b.authType=3,b.authGrade=3,y.value="按钮")):(b.authType=1,b.authGrade=1,b.parentId=0,y.value="模块")}}),(e,a)=>{const l=d("el-input"),t=d("el-form-item"),u=d("el-option"),o=d("el-select"),p=d("el-form"),i=d("el-button"),w=d("el-dialog");return r(),s(w,{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=e=>v.value=e),title:"添加权限",width:"25%",onClose:k,"destroy-on-close":""},{footer:h((()=>[n("span",_,[c(i,{onClick:k},{default:h((()=>[C])),_:1}),c(i,{type:"primary",onClick:U},{default:h((()=>[G])),_:1})])])),default:h((()=>[c(p,{ref:g,model:m(b),rules:m(V),"label-position":"top"},{default:h((()=>[c(t,{label:"名称：",prop:"authName"},{default:h((()=>[c(l,{modelValue:m(b).authName,"onUpdate:modelValue":a[0]||(a[0]=e=>m(b).authName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),c(t,{label:"权限描述：",prop:"authDesc"},{default:h((()=>[c(l,{modelValue:m(b).authDesc,"onUpdate:modelValue":a[1]||(a[1]=e=>m(b).authDesc=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),m(b).authGrade>1?(r(),s(t,{key:0,label:"权限url：",prop:"authUrl"},{default:h((()=>[c(l,{modelValue:m(b).authUrl,"onUpdate:modelValue":a[2]||(a[2]=e=>m(b).authUrl=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})):f("",!0),3==m(b).authGrade?(r(),s(t,{key:1,label:"权限code：",prop:"authCode"},{default:h((()=>[c(l,{modelValue:m(b).authCode,"onUpdate:modelValue":a[3]||(a[3]=e=>m(b).authCode=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})):f("",!0),c(t,{label:"分类"},{default:h((()=>[c(o,{modelValue:y.value,"onUpdate:modelValue":a[4]||(a[4]=e=>y.value=e)},{default:h((()=>[c(u,{label:"模块",value:"1",selected:1==m(b).authGrade,disabled:m(b).authGrade>1},null,8,["selected","disabled"]),c(u,{label:"列表",value:"2",selected:2==m(b).authGrade,disabled:2!=m(b).authGrade},null,8,["selected","disabled"]),c(u,{label:"按钮",value:"3",selected:3==m(b).authGrade,disabled:m(b).authGrade<3},null,8,["selected","disabled"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}}};const w={style:{"padding-bottom":"20px"}},N=p("添加权限"),I=p("修改权限"),D=p("启用权限"),E=p("禁用权限"),x=p("删除权限"),$={setup(l){const o=u(),s={children:"childAuth",label:"authName",class:e=>"0"==e.authState?"gray":""},m=u([]),p=()=>{a("/auth/auth-tree").then((e=>{m.value=e.data,f.value.setCheckedKeys([]),o.value=null}))};p();const f=u(),k=(e,a)=>{a.checkedKeys.length>0?(f.value.setCheckedKeys([e.authId]),o.value=e):o.value=null},y=u(),V=()=>{o.value?y.value.open(o.value):i.error("请选择一个权限！")},_=u(),C=()=>{!o.value||o.value.authGrade<3?_.value.open(o.value):i.error("当前权限不能添加子权限！")},G=()=>{e(`/auth/auth-enable/${o.value.authId}`).then((e=>{i.success(e.message),p()}))},$=()=>{e(`/auth/auth-disable/${o.value.authId}`).then((e=>{i.success(e.message),p()}))},K=()=>{t(`/auth/auth-delete/${o.value.authId}`,null,{title:"提示",message:"您确定删除该权限及其子权限吗？"}).then((e=>{i.success(e.message),p()}))};return(e,a)=>{const l=d("el-button"),t=d("el-tree");return r(),v(b,null,[n("div",w,[c(l,{type:"primary",onClick:C},{default:h((()=>[N])),_:1}),c(l,{type:"primary",onClick:V},{default:h((()=>[I])),_:1}),c(l,{type:"warning",onClick:G},{default:h((()=>[D])),_:1}),c(l,{type:"danger",onClick:$},{default:h((()=>[E])),_:1}),c(l,{type:"primary",onClick:K},{default:h((()=>[x])),_:1})]),c(t,{ref:f,data:m.value,props:s,"node-key":"authId",onCheck:k,"default-checked-keys":e.checkedKeys,"show-checkbox":"","check-strictly":""},null,8,["data","default-checked-keys"]),c(g,{ref:y,onOk:p},null,512),c(U,{ref:_,onOk:p},null,512)],64)}}};export default $;
