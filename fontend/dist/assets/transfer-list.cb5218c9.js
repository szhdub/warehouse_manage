import{g as e,p as l}from"./index.c283ea82.js";import{s as a,r as t,m as o,o as r,e as u,w as d,g as n,v as p,A as s,h as m,E as c,f as i,F as b,p as N,l as g,G as v,u as f,x as h}from"./vendor.15027bbd.js";const V={class:"dialog-footer"},I=m("取消"),y=m("确定"),_={emits:["ok"],setup(m,{expose:i,emit:b}){const N=a(!1),g=t({productName:"",targetProductNum:"",productInvent:"",transNum:"",sourceStoreId:"",sourceProductId:"",targetStoreId:""}),v=t({targetProductNum:[{validator:async(l,a,t)=>{if(""===a)return t(new Error("请输入商品编号！"));return!!(await e(`/transshipment/product-num-check?productNum=${a}`)).data||t(new Error("商品编号已存在！"))},trigger:"blur"}],transNum:[{validator:(e,l,a)=>{if(""===l)return a(new Error("请输入调货数量！"));const t=parseInt(g.productInvent);return parseInt(l)<=0?a(new Error("调货数量必须大于0！")):!(parseInt(l)>t)||a(new Error("调货数量不能大于库存！"))},trigger:"blur"}]}),f=()=>{for(let e in g)g[e]="";N.value=!1},h=a(),_=()=>{h.value.validate((e=>{e&&l("/transshipment/transshipment-add",g).then((e=>{b("ok"),c.success(e.message),N.value=!1}))}))};return i({open:(e,l)=>{N.value=!0,g.productName=e.productName,g.targetProductNum=e.productNum,g.productInvent=e.productInvent,g.sourceStoreId=e.storeId,g.sourceProductId=e.productId,g.targetStoreId=l}}),(e,l)=>{const a=o("el-input"),t=o("el-form-item"),m=o("el-form"),c=o("el-button"),i=o("el-dialog");return r(),u(i,{modelValue:N.value,"onUpdate:modelValue":l[4]||(l[4]=e=>N.value=e),title:"添加调货单",width:"500px",onClose:f,"destroy-on-close":""},{footer:d((()=>[n("span",V,[p(c,{onClick:f},{default:d((()=>[I])),_:1}),p(c,{type:"primary",onClick:_},{default:d((()=>[y])),_:1})])])),default:d((()=>[p(m,{ref:h,model:s(g),rules:s(v),"label-position":"top"},{default:d((()=>[p(t,{label:"商品名称：",prop:"productName"},{default:d((()=>[p(a,{modelValue:s(g).productName,"onUpdate:modelValue":l[0]||(l[0]=e=>s(g).productName=e),disabled:""},null,8,["modelValue"])])),_:1}),p(t,{label:"商品编号：",prop:"targetProductNum"},{default:d((()=>[p(a,{modelValue:s(g).targetProductNum,"onUpdate:modelValue":l[1]||(l[1]=e=>s(g).targetProductNum=e)},null,8,["modelValue"])])),_:1}),p(t,{label:"库存：",prop:"productInvent"},{default:d((()=>[p(a,{modelValue:s(g).productInvent,"onUpdate:modelValue":l[2]||(l[2]=e=>s(g).productInvent=e),disabled:""},null,8,["modelValue"])])),_:1}),p(t,{label:"调货数量：",prop:"transNum"},{default:d((()=>[p(a,{modelValue:s(g).transNum,"onUpdate:modelValue":l[3]||(l[3]=e=>s(g).transNum=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}}};N("data-v-65676410");const w=n("svg",{t:"1646977561352",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3057",width:"200",height:"200"},[n("path",{d:"M986.304 871.424L747.328 630.4c-2.816-2.752-5.888-4.928-8.768-7.232 40.32-62.464 63.936-136.832 63.936-216.96 0-220.16-176.96-398.592-395.392-398.592C188.8 7.616 11.712 186.048 11.712 406.208s177.088 398.592 395.392 398.592a391.232 391.232 0 0 0 215.36-64.576c2.24 3.072 4.352 6.08 7.04 8.832l239.04 241.024a82.688 82.688 0 0 0 117.76 0 84.48 84.48 0 0 0 0-118.656m-579.2-192.512c-149.12 0-270.528-122.368-270.528-272.704 0-150.4 121.344-272.768 270.528-272.768 149.12 0 270.528 122.432 270.528 272.768 0 150.4-121.408 272.704-270.528 272.704","p-id":"3058"})],-1),x=m("  查  询 "),U=m("调货");g();const k={setup(l){const m=t({storeId:1,productName:"",brandName:"",typeName:"",supplyName:"",placeName:"",pageSize:5,pageNum:1,totalNum:0}),N=a(),g=()=>{e("/transshipment/product-page-list",m).then((e=>{N.value=e.data.resultList,N.value=N.value.reduce(((e,l)=>(l.productInvent&&l.productInvent>0&&e.push(l),e)),[]),m.totalNum=e.data.totalNum}))};g();const V=a();e("/transshipment/store-list").then((e=>{V.value=e.data}));const I=a();e("/transshipment/brand-list").then((e=>{I.value=e.data}));const y=(e,l)=>{l(e?I.value.filter(k(e)):I.value)},k=e=>l=>-1!=l.brandName.indexOf(e),P=v(),z=a(),C=f(),S=()=>{C.push("/transshipment/index")},E=e=>{m.pageSize=e,g()},j=e=>{m.pageNum=e,g()};return(e,l)=>{const a=o("el-option"),t=o("el-select"),v=o("el-form-item"),f=o("el-input"),I=o("el-autocomplete"),k=o("el-icon"),C=o("el-button"),F=o("el-form"),L=o("el-table-column"),O=o("el-table"),q=o("el-pagination");return r(),i(b,null,[n("div",null,[p(F,{inline:"",class:"searchForm"},{default:d((()=>[p(v,{label:"选择仓库："},{default:d((()=>[p(t,{modelValue:s(m).storeId,"onUpdate:modelValue":l[0]||(l[0]=e=>s(m).storeId=e),style:{width:"120px"},onChange:g,clearable:""},{default:d((()=>[(r(!0),i(b,null,h(V.value,(e=>(r(),u(a,{label:e.storeName,value:e.storeId,key:e.storeId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(v,null,{default:d((()=>[p(f,{modelValue:s(m).productName,"onUpdate:modelValue":l[1]||(l[1]=e=>s(m).productName=e),placeholder:"商品名称",style:{width:"120px"},clearable:""},null,8,["modelValue"])])),_:1}),p(v,null,{default:d((()=>[p(I,{modelValue:s(m).brandName,"onUpdate:modelValue":l[2]||(l[2]=e=>s(m).brandName=e),"fetch-suggestions":y,"value-key":"brandName",clearable:"",placeholder:"品牌",style:{width:"120px"}},null,8,["modelValue"])])),_:1}),p(v,null,{default:d((()=>[p(f,{modelValue:s(m).typeName,"onUpdate:modelValue":l[3]||(l[3]=e=>s(m).typeName=e),placeholder:"类型",style:{width:"120px"},clearable:""},null,8,["modelValue"])])),_:1}),p(v,null,{default:d((()=>[p(f,{modelValue:s(m).supplyName,"onUpdate:modelValue":l[4]||(l[4]=e=>s(m).supplyName=e),placeholder:"供应商",style:{width:"120px"},clearable:""},null,8,["modelValue"])])),_:1}),p(v,null,{default:d((()=>[p(f,{modelValue:s(m).placeName,"onUpdate:modelValue":l[5]||(l[5]=e=>s(m).placeName=e),placeholder:"产地",style:{width:"120px"},clearable:""},null,8,["modelValue"])])),_:1}),p(v,null,{default:d((()=>[p(C,{type:"primary",onClick:g},{default:d((()=>[p(k,null,{default:d((()=>[w])),_:1}),x])),_:1})])),_:1})])),_:1})]),p(O,{data:N.value,style:{width:"100%","margin-top":"10px"},"table-layout":"auto",size:"large",border:"",stripe:""},{default:d((()=>[p(L,{prop:"productId",label:"商品ID",sortable:""}),p(L,{prop:"storeName",label:"仓库名称",sortable:""}),p(L,{prop:"productName",label:"商品名称",sortable:""}),p(L,{prop:"productNum",label:"商品编号",sortable:""}),p(L,{prop:"brandName",label:"品牌",sortable:""}),p(L,{prop:"typeName",label:"类型",sortable:""}),p(L,{prop:"supplyName",label:"供应商",sortable:""}),p(L,{prop:"placeName",label:"产地",sortable:""}),p(L,{prop:"productInvent",label:"库存",sortable:""}),p(L,{prop:"inPrice",label:"进价",sortable:""}),p(L,{prop:"unitName",label:"单位",sortable:""}),p(L,{label:"操作"},{default:d((e=>[p(C,{type:"primary",onClick:l=>(e=>{const l=P.query.storeId,a=e.storeId;e.productId,a==l?c.error("源仓库不能和目标仓库相同！"):z.value.open(e,l)})(e.row)},{default:d((()=>[U])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),p(q,{background:"",total:s(m).totalNum,"page-sizes":[5,10,15,20,25,30],"page-size":s(m).pageSize,"onUpdate:page-size":l[6]||(l[6]=e=>s(m).pageSize=e),currentPage:s(m).pageNum,"onUpdate:currentPage":l[7]||(l[7]=e=>s(m).pageNum=e),layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"},onSizeChange:E,onCurrentChange:j},null,8,["total","page-size","currentPage"]),p(_,{ref:z,onOk:S},null,512)],64)}},__scopeId:"data-v-65676410"};export default k;
